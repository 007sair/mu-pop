!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.mu=t()}(window,function(){var n="mu",s=0,c={},r=function(e,t){return(t=t||!1)?document.querySelectorAll(e):document.querySelector(e)},l=function(e,t){return n+(e?"-"+e:"")+(t?"--"+t:"")},f=function(e){var t=r("#mu-"+e);if(!t)return!1;var n=t.querySelector("."+l("mask")),i=t.querySelector("."+l("container")).children[0];return{wrap:t,mask:n,main:i}};function t(e){this.opts=function(e,t){for(var n in t)e[n]=t[n];return e}({type:"default",content:"",mask:!0,maskClose:!0,delay:.25,time:0,animate:"scale",style:"",className:"",btn:!1,offset:"center"},e),this.init()}function i(e,t){return 0!=(t=t||"").replace(/\s/g,"").length&&new RegExp(" "+t+" ").test(" "+e.className+" ")}function a(e,t){i(e,t)||(e.className=""==e.className?t:e.className+" "+t)}function o(e,t){if(i(e,t)){for(var n=" "+e.className.replace(/[\t\r\n]/g,"")+" ";0<=n.indexOf(" "+t+" ");)n=n.replace(" "+t+" "," ");e.className=n.replace(/^\s+|\s+$/g,"")}}function u(e,t){t=t||r("body"),e.parentNode===t&&t.removeChild(e)}t.prototype={constructor:t,init:function(){c[s]={config:this.opts,duration:{},delay:{}},this.insert()},insert:function(){var t=this,i=this.opts,e=document.createElement("div");e.id="mu-"+s,e.className=l("wrap"),e.setAttribute("type",i.type),[].slice.call(r("."+l("wrap"),!0)).forEach(function(e){var t=e.getAttribute("type"),n=e.id.split("mu-")[1];t===i.type&&d.close(n)}),"toast"===i.type&&(i.mask=!1),"alert"===i.type&&(i.content='<div class="'+l("alert_content")+'">'+i.content+"</div>"),"slide"===i.type&&(i.animate="slide"),"loading"===i.type&&(i.animate=!1,i.content=i.content?"<p>"+i.content+"</p>":i.content);var n=function(){var e=i.btn;"string"==typeof i.btn&&(e=[i.btn]);var t,n=(e||[]).length;return 0!==n&&e?(t='<span yes type="1">'+(e=e.slice(0).reverse())[0]+"</span>",2===n&&(t='<span no type="0">'+e[1]+"</span>"+t),'<div class="'+l("alert_btns")+'">'+t+"</div>"):""}(),a=[l("mask"),i.animate?l("fade"):""].join(" "),o=[l("main"),l(i.type),i.from?l(i.type,i.from):null,i.className?i.className:null,i.animate?l(i.animate):""].filter(function(e){return e}).join(" ");"function"==typeof i.content&&(i.content=i.content.call(this,function(e){f(t.index)&&f(t.index).main&&(f(t.index).main.innerHTML=e)})),e.innerHTML=[i.mask?'<div style="'+("string"==typeof i.mask?i.mask:"")+'" class="'+a+'"></div>':"",'<div class="'+l("container")+" "+l("container",i.offset)+'">','<div class="'+o+'" style="'+(i.style?i.style:"")+'">',i.title?'<div class="'+l("title")+'">'+i.title+"</div>":"",i.content,i.btn?n:"","</div>","</div>"].join(""),r("body").appendChild(e),this.index=s++,this.emit(i),"function"==typeof c[this.index].config.open&&c[this.index].config.open.call(this)},emit:function(t){var n=this,e=f(this.index);if(e.wrap.offsetWidth,t.animate&&a(e.main,l(t.animate,"in")),t.mask&&e.mask&&(t.animate&&a(e.mask,l("fade","in")),t.maskClose&&e.mask.addEventListener("click",function(){d.close(n.index)})),t.btn){var i=r("."+l("alert_btns")+" span",!0);[].slice.call(i).forEach(function(e){e.addEventListener("click",function(){0==this.getAttribute("type")?(t.no&&t.no(),d.close(n.index)):t.yes?t.yes(n.index):d.close(n.index)})})}t.time&&(c[this.index].duration=setTimeout(function(){d.close(n.index)},1e3*t.time))}};var d={v:"1.0.0",open:function(e){return new t(e||{}).index},toast:function(e,t){this.open({type:"toast",content:e,time:t||1.5})},loader:function(e){return e=e||"加载中..",this.open({type:"loading",mask:!1,content:e})},close:function(e){var t=f(e);if(t){var n=c[e].config;t.mask&&o(t.mask,l("fade","in")),o(t.main,l(n.animate,"in"));var i=n.animate?1e3*n.delay:0;clearTimeout(c[e].delay),c[e].delay=setTimeout(function(){u(t.wrap),"function"==typeof c[e].config.close&&c[e].config.close(),delete c[e]},i)}},closeAll:function(){var e=r("."+l("wrap"),!0);e.length&&[].slice.call(e).forEach(function(e){u(_wrap)})}};return window.mu=d});